# requires helm-kush plugin from https://github.com/oneilsh/helm-kush

# example deployment:
# helm kush upgrade prometheus ../charts/prometheus --kush-interpolate --install --values <thisfile>

# uninstall: helm delete prometheus -n cluster-tools 

kubeContext: example-cluster
createNamespace: cluster-tools
clusterHostname: example-cluster.datasci.oregonstate.edu

configmapReload:
  prometheus:
    image: 
      repository: localhost:30050/jimmidyson/configmap-reload
  alertmanager:
    image: 
      repository: localhost:30050/jimmidyson/configmap-reload

pushgateway:
  image:
    repository: localhost:30050/prom/pushgateway
  nodeSelector:
    nodegroup-role: clustertools

kubeStateMetrics:
  enabled: false
  nodeSelector:
    nodegroup-role: clustertools
  service:
    annotations: {}
  labels: {}

alertmanager:
  image: 
    repository: localhost:30050/prom/alertmanager
  nodeSelector:
    nodegroup-role: clustertools

server:
  image:
    repository: localhost:30050/prom/prometheus
  nodeSelector:
    nodegroup-role: clustertools
  resources:
    limits:
      cpu: 1000m
      memory: 3Gi
    requests:
      cpu: 500m
      memory: 2Gi
  ingress:
    enabled: true
    ingressClassName: nginx
    annotations:
      nginx.org/mergeable-ingress-type: "minion"
      # I'm not sure this is the right syntax - https://docs.nginx.com/nginx-ingress-controller/configuration/ingress-resources/advanced-configuration-with-annotations/
      nginx.org/websocket-services: "prometheus"
    path: /<%= $RELEASE_NAME %>/
    hosts:
      - <%= $(index clusterHostname "") %>

nodeExporter:
  image:
    repository: localhost:30050/prom/node-exporter
  tolerations:
  - effect: NoSchedule
    key: hub.jupyter.org/dedicated
    operator: Equal
    value: user
  - effect: NoSchedule
    key: hub.jupyter.org_dedicated
    operator: Equal
    value: user
